---
title: "traceback_function"
output: html_document
---

```{r}
# functionalise
  traceback_funk <- function(scoring_matrix, seq_1, seq_2) {
  # inputs are the scoring matrix and sequences, with seq_1 corresponding vertically to the matrix, and seq_2 horizontally
    
  # find maximum value in scoring matrix and allocate as score and start position
  score <- max(scoring_matrix)
  start_position <- which(scoring_matrix == score, arr.ind = TRUE)
  
  # for loop over all possible start positions
  for(i in 1:nrow(start_position)) {
    
    position <- start_position[i,]
    
    # create alignment variables
    alignment_vector <- c(seq_1[position[1]-1],seq_2[position[2]-1])
    alignment_matrix <- matrix(alignment_vector)
    
    #while (scoring_matrix[position] != 0) {
      for (n in 1:alignment_length) { # need to figure out how to loop over length
        
        # Create vector of next possible steps
        vertical <- scoring_matrix[position[1] -1, position[2]]
        horizontal <- scoring_matrix[position[1], position[2] -1]
        diagonal <- scoring_matrix[position[1] -1, position[2] -1]
        
        # initialise step vector otherwise diagonal doesn't work!!!!
        step_vec <- rep(0,3)
        step_vec <- step_vec + c(vertical, horizontal, diagonal)
        step <- max(step_vec)
      
        if (step == diagonal) {
          # if the diagonal is equal to the maximum value in the step_vec, position moves up and left
          jump <- c(-1,-1)
          position <- position + jump
          # new alignment vector contains values from both sequences
          alignment_vector <- c(seq_1[position[1]-1],seq_2[position[2]-1])
          alignment_matrix <- cbind(alignment_matrix, alignment_vector)
        } else if (step == horizontal) {
          jump <- c(0,-1)
          position <- position + jump
          # new alignment vector contains values only from seq_2
          alignment_vector <- c('_',seq_2[position[2]-1])
          alignment_matrix <- cbind(alignment_matrix, alignment_vector)
        } else {
          jump <- c(-1,0)
          position <- position + jump
          # new alignment vector contains values only from seq_1
          alignment_vector <- c(seq_1[position[1]-1],'_')
          alignment_matrix <- cbind(alignment_matrix, alignment_vector)
        }
      #print(position)
    }
  }
  return(alignment_matrix)
}
```