---
title: "Dynamic Programming_Traceback"
output: html_document
---

```{r setup, include=FALSE}
rm(list = ls())
```

```{r}
# Temporary Input Variables

scoring_matrix <- matrix(1:16, nrow = 4, ncol = 4)
scoring_matrix[1,] <- 0
scoring_matrix[,1] <- 0
#scoring_matrix <- t(scoring_matrix)
seq_1 <- c('a','b','c')
seq_2 <- c('c','d','e')

print(scoring_matrix)
```
```{r}
# find maximum value in scoring matrix and allocate as score
score <- max(scoring_matrix)
start_position <- which(scoring_matrix == score, arr.ind = TRUE)
print(start_position)
```
```{r}
# move to next position in scoring matrix
position <- start_position

while (scoring_matrix[position] != 0) {

  # Create vector of next possible steps
  vertical <- scoring_matrix[position[1] -1, position[2]]
  horizontal <- scoring_matrix[position[1], position[2] -1]
  diagonal <- scoring_matrix[position[1] -1, position[2] -1]

  step_vec <- c(vertical, horizontal, diagonal)
  step <- max(step_vec)
  
  #create movement vector
  jump <- c(0,0)
  
  if(step == diagonal) {
    jump <- c(-1, -1)
  } else if (step == horizontal) {
    jump <- c(0, -1)
  } else {
    jump <- c(-1, 0)
  }
  
  # new position vector is old + movement
  position <- position + jump
  
  print(scoring_matrix[position]) }
```
